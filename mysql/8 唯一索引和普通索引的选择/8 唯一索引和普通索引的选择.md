# 唯一索引和普通索引的选择

- 非读多的场景，尽量使用普通索引。
- 从查询和更新的流程分析来看
- 查询
    - 都是通过B+树查询
    - 唯一索引的查找过程
        - 由于唯一索引具有唯一性，查找到第一个满足的条件即中止
    - 普通索引的查找过程
        - 查找到第一个满足的记录后，需要继续查找，直到第一个不满足的记录
    - 从IO角度说，普通索引多了一次指针查询。
        - MySQL的页默认16KB，可以存放上千个key。MySQL以页为单位读取数据，并且有相邻页读取的优化（操作系统默认一次读取64KB），因此相邻的key大概率是被一起读到的。
    - 所以`查询的性能是相似的，差距微乎其微`。
- 更新
    - 如果更新的目标在内存中
        - 唯一索引会找到该索引的位置，判断没有冲突就直接插入
        - 普通索引会找到该索引的位置，直接插入
    - 如果更新的目标不在内存中
        - 唯一索引从会磁盘上读取数据页到内存中再操作
        - `普通索引会将语句直接记录在change buffer`，语句就执行结束了
    - 所以`普通索引对更新的提升是显而易见`的。
-