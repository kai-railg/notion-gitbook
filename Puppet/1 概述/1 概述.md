# 1 概述

- puppet是一个配置管理工具, 典型的, puppet是一个C/S结构，也可以说是一个星型结构
- 所有的puppet客户端同一个服务器端的puppet通讯. 每个puppet客户端每半小时(可以设置)连接一次服务器端, 下载最新的配置文件,并且严格按照配置文件来配置服务器. 配置完成以后,puppet客户端可以反馈给服务器端一个消息. 如果出错,也会给服务器端反馈一个消息
- puppet的配置具有稳定性, puppet就会根据配置文件来更改你的机器配置,通常每30分钟检查一次. puppet会让你的系统状态同配置文件所要求的状态保持一致
- puppet把系统里面的用户,软件包,服务 看作是"资源", puppet的作用就是管理这些资源以及资源之间的相互联系.
- puppet有很多的资源类型,例如文件,用户,软件包,服务, 不同的操作系统上对资源的管理命令是不一样的, 例如debian下面用apt-get安装软件,redhat下面用yum安装软件
- puppet 通过管理资源的方式来管理系统, 有一种特殊的属性可以用在所有的资源上面,这种属性叫做 metaparams ( 元参数或者元属性).
- 支持资源之间的关系配置是puppet的关键特性之一, puppet会优先配置被依赖的资源

- 工作原理
    1. 客户端puppetd 调用facter ，facter 会探测出这台主机的一些变量如主机名、内存大小、IP 地址等。然后puppetd 把这些信息发送到服务器端。
    2. 服务器端的puppetmaster 检测到客户端的主机名，然后会到manifest 里面对应的node 配置，然后对这段内容进行解析，facter 送过来的信息可以作为变量进行处理的，node 牵涉到的代码才解析，其它的代码不不解析，解析分几个过程：语法检查、然后会生成一个中间的伪代码，然后再把伪代码发给客户机。
    3. 客户端接收到伪代码之后就会执行，客户端再把执行结果发送给服务器。
    4. 服务器再把客户端的执行结果写入日志。