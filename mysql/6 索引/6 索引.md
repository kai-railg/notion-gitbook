# 索引

- InnoDB的数据模型
    - 表都是按照主键顺序以索引的形式存放的，这种存储方式的表称为`索引组织表`
    - InnoDB使用B+树索引模型，所有数据都是存储在B+树中的
        - 索引分为主键索引和非主键索引
        - 其中一个索引对应一颗B+树，主键索引与非主键索引的叶子节点存放数据不同
        - 主键的叶子节点存放数据，非主键索引的叶子结点存放主键的值
        - 基于主键索引查询，只需要搜索主键索引B+树
        - 基于非主键索引查询，需要查询到主键ID再根据ID查询数据，称为`回表`。
            - `覆盖索引`的情况，如果非主键索引的叶子节点包含需要查询所有的值，就直接返回，不需要回表
    - B树、B-树、B+树、B*树的区别
        - B树：多叉搜索树
        - B-树：多路搜索树，非叶子节点存储指向关键字范围的子节点
        - `B+树`：B-树的基础上，为叶子节点添加链表指针，所有的关键字都在叶子节点出现
            - 特点：
                - 多路搜索树
                - 高度一般不超过4
                - 高扇出性
                - 叶子节点存储所有关键字
                - 叶子节点使用链表指针连接
        - B*树：在B+树基础上，非叶子节点也增加链表指针
    - 非主键索引的定义
        - InnoDB会把主键字段放到`索引定义字段后面`，同时去重
        - 比如主键索引 a, b
            - 定义索引为c时，实际上是 c,a,b
            - 定义索引为c,a时，实际上是 c,a,b
            - 定义索引为 c, b时，实际上是 c,b,a
    - 最左前缀原则
        - 提升索引的复用能力
        - 比如`联合索引(a, b, c)`，其中a是索引，a, b 也是索引， a, b, c也是索引。且只使用一颗B+树。
    - 索引下推
        - 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。
        - 比如`联合索引(a, b)` 如果a满足条件，不使用索引下推则回表判断b是否满足条件，使用索引下推直接判断b是否满足条件，不满足就不回表。