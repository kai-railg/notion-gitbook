# 3 倒排索引

- 倒排索引核心包括两部分
    - 单词词典，记录所有文档的单词，记录单词到倒排列表的关联关系
        - 单词列表一般比较大，可以通过B+树或哈希拉链法实现
    - 倒排列表，记录了单词对应的文档结合，由倒排索引项组成
        - 倒排索引项：
            - 文档ID
            - 词频TF，该单词在文档中出现的次数，用于相关性打分
            - 位置，单词在文档中分词的位置，用于语句搜索
            - 偏移，记录单词的开始、结束位置，实现高亮显示
    - ES的JSON文档中的每个字段都有自己的倒排索引，可以指定某些字段不做索引
- 倒排索引的不可变性
    - 倒排索引一旦生成，不可更改
    - 不可变性的优点
        - 无需考虑并发写文件的问题，避免了锁机制的性能问题
        - 读入并常驻内核的文件系统缓存
        - 缓存容易生成和维护，并且数据可以被压缩